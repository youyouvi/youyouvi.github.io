<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.0 -->
    <script>
        window.materialVersion = "1.5.0"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">



    <link rel="dns-prefetch" href="https://busuanzi.ibruce.info"/>












    <!-- Title -->
    
    <title>
        
            并发 | 
        
        Ember
    </title>

    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="format-detection" content="telephone=no"/>
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="子语">
    <meta name="description" itemprop="description" content="一切有为法,如梦幻泡影。如露亦如电,应作如是观。">
    <meta name="keywords" content="Blog,Go基础">

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(key){try{localStorage.removeItem(key)}catch(e){}};lsloader.setLS=function(key,val){try{localStorage.setItem(key,val)}catch(e){}};lsloader.getLS=function(key){var val="";try{val=localStorage.getItem(key)}catch(e){val=""}return val};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var keys=[];for(var i=0;i<localStorage.length;i++){keys.push(localStorage.key(i))}keys.forEach(function(key){var data=lsloader.getLS(key);if(window.oldVersion){var remove=window.oldVersion.reduce(function(p,c){return p||data.indexOf("/*"+c+"*/")!==-1},false);if(remove){lsloader.removeLS(key)}}})}catch(e){}};lsloader.clean();lsloader.load=function(jsname,jspath,cssonload,isJs){if(typeof cssonload==="boolean"){isJs=cssonload;cssonload=undefined}isJs=isJs||false;cssonload=cssonload||function(){};var code;code=this.getLS(jsname);if(code&&code.indexOf(versionString)===-1){this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload,isJs);return}if(code){var versionNumber=code.split(versionString)[0];if(versionNumber!=jspath){console.log("reload:"+jspath);this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload,isJs);return}code=code.split(versionString)[1];if(isJs){this.jsRunSequence.push({name:jsname,code:code});this.runjs(jspath,jsname,code)}else{document.getElementById(jsname).appendChild(document.createTextNode(code));cssonload()}}else{this.requestResource(jsname,jspath,cssonload,isJs)}};lsloader.requestResource=function(name,path,cssonload,isJs){var that=this;if(isJs){this.iojs(path,name,function(path,name,code){that.setLS(name,path+versionString+code);that.runjs(path,name,code)})}else{this.iocss(path,name,function(code){document.getElementById(name).appendChild(document.createTextNode(code));that.setLS(name,path+versionString+code)},cssonload)}};lsloader.iojs=function(path,jsname,callback){var that=this;that.jsRunSequence.push({name:jsname,code:""});try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(path,jsname,xhr.response);return}}that.jsfallback(path,jsname)}};xhr.send(null)}catch(e){that.jsfallback(path,jsname)}};lsloader.iocss=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.iofonts=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.runjs=function(path,name,code){if(!!name&&!!code){for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code=code}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var script=document.createElement("script");script.appendChild(document.createTextNode(this.jsRunSequence[0].code));script.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(script);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var that=this;var script=document.createElement("script");script.src=this.jsRunSequence[0].path;script.type="text/javascript";this.jsRunSequence[0].status="loading";script.onload=function(){that.jsRunSequence.shift();if(that.jsRunSequence.length>0){that.runjs()}};document.body.appendChild(script)}};lsloader.tagLoad=function(path,name){this.jsRunSequence.push({name:name,code:"",path:path,status:"failed"});this.runjs()};lsloader.jsfallback=function(path,name){if(!!this.jsnamemap[name]){return}else{this.jsnamemap[name]=name}for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code="";this.jsRunSequence[k].status="failed";this.jsRunSequence[k].path=path}}this.runjs()};lsloader.cssfallback=function(path,name,cssonload){if(!!this.cssnamemap[name]){return}else{this.cssnamemap[name]=1}var link=document.createElement("link");link.type="text/css";link.href=path;link.rel="stylesheet";link.onload=link.onerror=cssonload;var root=document.getElementsByTagName("script")[0];root.parentNode.insertBefore(link,root)};lsloader.runInlineScript=function(scriptId,codeId){var code=document.getElementById(codeId).innerText;this.jsRunSequence.push({name:scriptId,code:code});this.runjs()};lsloader.loadCombo=function(jslist){var updateList="";var requestingModules={};for(var k in jslist){var LS=this.getLS(jslist[k].name);if(!!LS){var version=LS.split(versionString)[0];var code=LS.split(versionString)[1]}else{var version=""}if(version==jslist[k].path){this.jsRunSequence.push({name:jslist[k].name,code:code,path:jslist[k].path})}else{this.jsRunSequence.push({name:jslist[k].name,code:null,path:jslist[k].path,status:"comboloading"});requestingModules[jslist[k].name]=true;updateList+=(updateList==""?"":";")+jslist[k].path}}var that=this;if(!!updateList){var xhr=new XMLHttpRequest;xhr.open("get",combo+updateList,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){that.runCombo(xhr.response,requestingModules);return}}else{for(var i in that.jsRunSequence){if(requestingModules[that.jsRunSequence[i].name]){that.jsRunSequence[i].status="failed"}}that.runjs()}}};xhr.send(null)}this.runjs()};lsloader.runCombo=function(comboCode,requestingModules){comboCode=comboCode.split("/*combojs*/");comboCode.shift();for(var k in this.jsRunSequence){if(!!requestingModules[this.jsRunSequence[k].name]&&!!comboCode[0]){this.jsRunSequence[k].status="comboJS";this.jsRunSequence[k].code=comboCode[0];this.setLS(this.jsRunSequence[k].name,this.jsRunSequence[k].path+versionString+comboCode[0]);comboCode.shift()}}this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/fa.png">
    <link rel="icon" sizes="192x192" href="/img/fa.png">
    <link rel="apple-touch-icon" href="/img/mao.png">

    <!--iOS -->
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Ember">

    <!-- Site Verification -->
    
    <meta name="baidu-site-verification" content="k8tNw6G5YO" />

    <!-- RSS -->
    

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?MKetZV3cUTfDxvMffaOezg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        
            
                <style id="prettify_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_css","/css/prettify.min.css?zp8STOU9v89XWFEnN+6YmQ==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
                <style id="prettify_theme"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_theme","/css/prettify/tomorrow-night-eighties.min.css?2LJQzURO+Kr8r/fl/T8oMA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
            
        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #000000 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #000000 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #000000 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-image: url(/img/bg6.jpg);
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.proxy.ustclug.org/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icon -->

    <link href="https://fonts.proxy.ustclug.org/icon?family=Material+Icons" rel="stylesheet">




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==", true)</script>
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://yov.oschina.io">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="并发 | Ember">
    <meta property="og:image" content="http://yov.oschina.io/img/fa.png" />
    <meta property="og:description" content="一切有为法,如梦幻泡影。如露亦如电,应作如是观。">
    <meta property="og:article:tag" content="Go基础"> 

    
        <meta property="article:published_time" content="Wed Jan 17 2018 20:27:17 GMT+0800" />
        <meta property="article:modified_time" content="Sun Jan 21 2018 21:06:41 GMT+0800" />
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:title" content="并发 | Ember">
    <meta name="twitter:description" content="一切有为法,如梦幻泡影。如露亦如电,应作如是观。">
    <meta name="twitter:image" content="http://yov.oschina.io/img/fa.png">
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="http://yov.oschina.io" />

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://yov.oschina.io/article/Go/Go Base/并发/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "http://yov.oschina.io/article/Go/Go Base/并发/index.html",
    "headline": "并发",
    "datePublished": "Wed Jan 17 2018 20:27:17 GMT+0800",
    "dateModified": "Sun Jan 21 2018 21:06:41 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "子语",
        "image": {
            "@type": "ImageObject",
            "url": "/img/head.jpg"
        },
        "description": "一切有为法,如梦幻泡影.如露亦如电,应作如是观."
    },
    "publisher": {
        "@type": "Organization",
        "name": "Ember",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/fa.png"
        }
    },
    "keywords": ",Go基础Blog",
    "description": "一切有为法,如梦幻泡影。如露亦如电,应作如是观。",
}
</script>


    

    <!-- Analytics -->
    
    
    

    <!-- Custom Head -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#并发与并行"><span class="post-toc-number">1.</span> <span class="post-toc-text"> 并发与并行</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#goroutine"><span class="post-toc-number">2.</span> <span class="post-toc-text"> goroutine</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#竞争状态"><span class="post-toc-number">3.</span> <span class="post-toc-text"> 竞争状态</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#锁住共享资源"><span class="post-toc-number">4.</span> <span class="post-toc-text"> 锁住共享资源</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#原子函数"><span class="post-toc-number">4.1.</span> <span class="post-toc-text"> 原子函数</span></a></li></ol></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                并发
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/head.jpg" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>子语</strong>
        <span>2018 - 01 - 17</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    
        <button id="article-functions-qrcode-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">devices other</i>
    <span class="visuallyhidden">devices other</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-qrcode-button">
    <li class="mdl-menu__item">在其它设备中阅读本文章</li>
    
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACX0lEQVR42u3aQXKDMAwFUO5/6fYAKcmXjAXNPFYZmhQ/L7DmS8fPV18HHh4eHh4eHh7ew3hHfJ396vX+H488+W9nn5fWhoeHhzfC+/Cqffud1yXmmLMlrqwNDw8Pb5JXXVbyq+o3q9uBh4eH9x95+fGQF+t4eHh438fLD4wE/D6MwMPDw3sy76q4oXoAJBs0lLXg4eHhxby88J3/PNrfw8PDwwt45ZGmeAuStlnSBhudKcPDw8MLeCsFcT6SlQ8fVLcSDw8P7y5eHqrm91fiid6z8PDw8GZ41XGovICuNrd6UTIeHh7eXbzqAVBtg+Wlc3JnKcbFw8PDu5TXK3bz0Lb3ufpcPDw8vEle8vruleDVXyVIPDw8vHt5edCQx7XJxuWBRR5h4OHh4U3yerFscxGtsYOlBhgeHh7eBl5zyKl1JOSFcvmwwcPDw9vMqw5F9Y6N9eghL/Hx8PDwdvOqS8+XmAN6TbilkhoPDw/vIl61RM4fWS3cqyNfeHh4eJO8alGbR7p57NtrreHh4eE9h7cSSeTBa7X1VbiDh4eHdyuv9yq/ahyhWnbj4eHhPYGXRwzVIYAdzTY8PDy8u3grS0kK3+Sv+Ubj4eHhzfOqV7XUTuKDPMwtHwx4eHh4G3hHfPUaY/lykxGu6D/j4eHhjfB6cUO+0Hw0YWU78PDw8OZ5+Qu6PAjVapXd0N/Dw8PD28bLG2b5C716FG08GPDw8PC21ZzVcnn9MIiOGTw8PLxBXt6Uyjel1wyrgvHw8PDmeb0IYKUxloS51cgDDw8Pb4b3fRceHh4eHh4eHt4Drl9Pa7k1PS+GDQAAAABJRU5ErkJggg==">
    
</ul>

    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/Go基础/">Go基础</a>
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    
        
            <!-- Busuanzi Views -->
            <a class="post_share-link" href="#">
                <li class="mdl-menu__item">
                    <span id="busuanzi_container_page_pv">
                        <span id="busuanzi_value_page_pv"></span>&nbsp;浏览量
                    </span>
                </li>
            </a>
        
    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=并发&url=http://yov.oschina.io/article/Go/Go Base/并发/index.html&pic=http://yov.oschina.io/img/fa.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    

    <!-- Share Facebook -->
    

    <!-- Share Google+ -->
    

    <!-- Share LinkedIn -->
    
        <a class="post_share-link" href="https://www.linkedin.com/shareArticle?mini=true&url=http://yov.oschina.io/article/Go/Go Base/并发/index.html&title=并发" target="_blank">
            <li class="mdl-menu__item">
                分享到 LinkedIn
            </li>
        </a>
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=Ember&title=并发&summary=一切有为法,如梦幻泡影。如露亦如电,应作如是观。&pics=http://yov.oschina.io/img/fa.png&url=http://yov.oschina.io/article/Go/Go Base/并发/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Telegram -->
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <p>通常程序都是顺序执行且代码只是为了完成独立的一个任务，因为这样的代码易写易维护。但某些情况下，并行执行多个任务更有好处，比如Web服务需要在各自的套接字（socket）上同时接收多少数据请求。每个套接字请求都是独立的，可以独立其他套接字进行处理，此时并行执行多个请求可以显著提高服务。Go语言的语法和运行时内置了对并发的支持。</p>
<p>Go中的并发指的是能让某个函数独立于其他函数运行。当一个函数创建为<code>goroutine</code>时，Go会将其视为一个独立的工作单元，这个单元会被调度到可用的逻辑处理器上运行。Go语言运行时的调度器是一个复杂的软件，能管理被创建的所有	<code>goroutine</code>并为其分配执行时间。这个调度器在操作系统之上，将操作系统的线程与语言运行时的逻辑处理器绑定，并在逻辑处理器上运行<code>goroutine</code>。调度器在任何给定的时间，都会全面控制某个<code>goroutine</code>要在某个逻辑处理器上运行。</p>
<p>Go语言的并发同步模型来自一个叫做通信顺序进程<code>Communicating Sequential Processes, CSP</code>的范型<code>paradigm</code>。CSP是一种消息传递模型，通过在<code>goroutine</code>间传递数据来传递消息，而不是对数据进行加锁从而实现同步。用于在<code>goroutime</code>之间同步和传递数据的关键数据类型叫作通道<code>channel</code>。</p>
<h2 id="并发与并行"><a class="markdownIt-Anchor" href="#并发与并行"></a> 并发与并行</h2>
<p>什么是操作系统的线程（thread）和进程（process）。当运行一个应用程序时，操作系统会为其启动一个进程。可以将这个进程看作一个包含了应用程序在运行中需要用到和维护的各种资源的容器。</p>
<p>进程中的资源包括但不限于内存地址空间、文件和设备的句柄以及线程。一个线程是一个执行空间，这个空间会被操作系统调度用来运行函数中所写的代码。每个进程至少包含一个线程，每个进程的初始线程被称为<code>主线程</code>。因为执行这个线程的空间是应用程本身的空间，所以当主线程终止时，应用程序也会终止。操作系统会将线程调度到某个处理器上运行，但这个处理器不一定是进程所在的处理器。</p>
<p>操作系统会在物理处理器上调度线程来运行，而Go的运行时会在逻辑处理器上调度<code>goroutine</code>来运行。Go1.5之前，默认给整个应用程序只分配一个逻辑处理器；1.5之后运行时会默认为每个可用的物理处理器分配一个逻辑处理器。这些逻辑处理器会用于执行所有被创建的<code>goroutime</code>，即便只有一个逻辑处理器，Go依然可以并发调度无数个<code>goroutine</code>。</p>
<p>如果创建一个<code>goroutine</code>并准备运行，这个<code>goroutine</code>就会被放到调度器的全局队列中，之后调度器就会将队列中的<code>goroutine</code>分配给一个逻辑处理器，并放到这个逻辑处理器对应的本地运行队列中，本地运行队列中的<code>goroutine</code>会一直等待直到自己被分配逻辑处理器执行。</p>
<p>有时，正在运行的<code>goroutine</code>需要执行一个阻塞的系统调用，如打开一个文件。当这类调用发生时，线程和<code>goroutine</code>会从逻辑处理器上分离，该线程会继续阻塞，等待系统调用的返回。同时，这个逻辑处理器就失去了用来运行的线程。所以调度器会创建一个新线程，并将其绑定到该逻辑处理器上。之后，调度器会从本地运行队列中选择另一个<code>goroutine</code>来运行。一旦被阻塞的系统调用执行完成并返回，对应的<code>goroutine</code>会放回到本地运行队列，而之前的线程会保存好，以便后面继续使用。</p>
<p>调度器对可以创建的逻辑处理器的数量没有限制，但语言运行时默认限制每个程序最多创建10000个线程，超过这个限制，就会崩溃，可以通过调用<code>runtime/debug</code>包中的<code>SetMaxThreads</code>来更改。</p>
<p>并发<code>concurrency</code>不是并行<code>parallelism</code>。并行是让不同的代码片段同时在不同的物理处理器上执行，其关键是同时做很多事情。并发是指同时管理很多事情。大部分情况下，并发的效果比并行好，因为操作系统和硬件的总资源一般很少，但能支持系统同时做很多事。</p>
<h2 id="goroutine"><a class="markdownIt-Anchor" href="#goroutine"></a> goroutine</h2>
<p>下述程序会创建两个<code>goroutine</code>，以并发的形式分别显示大写和小写字母：</p>
<pre class="highlight"><code class="go"><span class="keyword">package</span> main

<span class="keyword">import</span> (
   <span class="string">"runtime"</span>
   <span class="string">"sync"</span>
   <span class="string">"fmt"</span>
)

<span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {
   <span class="comment">// 分配一个逻辑处理器给调度器用</span>
   runtime.GOMAXPROCS(<span class="number">1</span>)

   <span class="comment">// wg用于等待程序完成</span>
   <span class="keyword">var</span> wg sync.WaitGroup
   <span class="comment">// 计数+2.表示要等待两个goroutine</span>
   wg.Add(<span class="number">2</span>)

   fmt.Println(<span class="string">"Start Goroutines"</span>)

   <span class="comment">// 声明一个匿名函数，并创建一个goroutine</span>
   <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> {
      <span class="keyword">defer</span> wg.Done()

      <span class="keyword">for</span>  count := <span class="number">0</span>; count &lt; <span class="number">3</span>; count++ {
         <span class="keyword">for</span> char := <span class="string">'a'</span>; char &lt; <span class="string">'a'</span> + <span class="number">26</span> ; char++ {
            fmt.Printf(<span class="string">"%c "</span>, char)
         }
      }
   }()

   <span class="comment">// 声明一个匿名函数，并创建一个goroutine</span>
   <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> {
      <span class="keyword">defer</span> wg.Done()

      <span class="keyword">for</span>  count := <span class="number">0</span>; count &lt; <span class="number">3</span>; count++ {
         <span class="keyword">for</span> char := <span class="string">'A'</span>; char &lt; <span class="string">'A'</span> + <span class="number">26</span> ; char++ {
            fmt.Printf(<span class="string">"%c "</span>, char)
         }
      }
   }()

   fmt.Println(<span class="string">"Waiting To Finish"</span>)
   <span class="comment">// 等待goroutine</span>
   wg.Wait()

   fmt.Printf(<span class="string">"\n Termingating Program"</span>)
}
</code></pre>
<p><code>runtime</code>包的<code>GOMAXPROCES</code>函数用于更改调度器可以使用的逻辑处理器数量。声明了两个匿名函数，分别通过关键字<code>go</code>创建<code>goroutine</code>来执行。</p>
<p><code>WaitGroup</code>是一个计数信号量，用来记录并维护运行的<code>goroutine</code>，如果<code>WaitGroup</code>大于0，则<code>Wait</code>方法会阻塞。上述代码中将<code>WaitGroup</code>设为2，表示有2个正在运行的<code>goroutine</code>，为了减小<code>WaitGroup</code>的值并最终释放main函数，在两个匿名函数中，使用<code>defer</code>定声明了函数退出时调用<code>Done</code>方法。<code>defer</code>会修改函数调用时机，在正在执行的函数返回时，才会调用<code>defer</code>声明的函数。</p>
<pre class="highlight"><code class="go">Start Goroutines
Waiting To Finish
A B C D E F G H I J K L M N O P Q R S T U V W X Y Z A B C D E F G H I J K L M N O P Q R S T U V W X Y Z A B C D E F G H I J K L M N O P Q R S T U V W X Y Z a b c d e f g h i j k l m n o p q r s t u v w x y z a b c d e f g h i j k l m n o p q r s t u v w x y z a b c d e f g h i j k l m n o p q r s t u v w x y z 
 Termingating Program
</code></pre>
<p>第一个<code>goroutine</code>完成显示花费的时间太短，以至于在调度器切换到第二个<code>goroutine</code>前就完成了所有任务，这就是为什么先输出了所有的大写字母，再输出了所有小写字母的原因。</p>
<p>基于调度器的内部算法，一个正在运行的<code>goroutine</code>在工作结束前，可以被停止并被重新调度。这样做的目的是防止某个<code>goroutine</code>长时间占用逻辑处理器。可通过下述例子说明：下述程序创建了一个需要长时间才能完成其工作 的<code>goroutine</code>：</p>
<pre class="highlight"><code class="go"><span class="keyword">package</span> main

<span class="keyword">import</span> (
   <span class="string">"sync"</span>
   <span class="string">"runtime"</span>
   <span class="string">"fmt"</span>
)

<span class="keyword">var</span> wg sync.WaitGroup

<span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {
   <span class="comment">// 分配一个逻辑处理器给调度器使用</span>
   runtime.GOMAXPROCS(<span class="number">1</span>)

   <span class="comment">// 计数+2，表示要等待2个goroutine</span>
   wg.Add(<span class="number">2</span>)

   fmt.Println(<span class="string">"Create Goroutines"</span>)
   <span class="comment">// 创建两个goroutine</span>
   <span class="keyword">go</span> printPrime(<span class="string">"A"</span>)
   <span class="keyword">go</span> printPrime(<span class="string">"B"</span>)

   fmt.Println(<span class="string">"Waitting To Finish"</span>)
   <span class="comment">// 等待goroutine结束</span>
   wg.Wait()

   fmt.Println(<span class="string">"Termination Program"</span>)

}

<span class="comment">// 显示5000以内的素数</span>
<span class="function"><span class="keyword">func</span> <span class="title">printPrime</span><span class="params">(prefix <span class="keyword">string</span>)</span></span> {
   <span class="comment">// 函数退出时，调用Done来通知main函数工作完成</span>
   <span class="keyword">defer</span> wg.Done()

next:
   <span class="keyword">for</span> outer := <span class="number">2</span>; outer &lt; <span class="number">5000</span>; outer++ {
      <span class="keyword">for</span> inner := <span class="number">2</span>; inner &lt; outer; inner++ {
         <span class="keyword">if</span> outer % inner == <span class="number">0</span> {
            <span class="keyword">continue</span> next
         }
      }
      fmt.Printf(<span class="string">"%s:%d\n"</span>, prefix, outer)
   }
   fmt.Println(<span class="string">"Completed"</span>, prefix)
}
</code></pre>
<p>运行程序，会看到素数的前缀最开始为B，当到了一定数量后，前缀切换为A。之后前缀A运行一段时间后，又会切换到B去。每次运行程序，调度器切换的时间点可能会不同。</p>
<p>上述程序中都有用到<code>runtime</code>包中的<code>GOMAXPROCS</code>函数来设置调度器使用的逻辑处理器数量。用这个函数，可以给每个可用的物理处理器在运行时分配一个逻辑处理器，才能使得<code>goroutine</code>并行运行。</p>
<p><code>runtime.GOMAXPROCS(runtime.NumCPU())</code>，<code>NumCPU()</code>会返回可以使用的物理处理器的数量，因此这行代码就相当于给每个可用的物理处理器创建一个逻辑处理器。使用多个逻辑处理器并不意味着性能更优。修改用于显示字母表的代码，将其中的</p>
<pre class="highlight"><code class="go">    fmt.Println(runtime.NumCPU())
	runtime.GOMAXPROCS(runtime.NumCPU())
</code></pre>
<p>此时可以看到输出结果：</p>
<pre class="highlight"><code class="go"><span class="number">4</span> <span class="comment">// 物理主机为4核，即有4个物理处理器</span>
Start Goroutines
Waiting To Finish
A B C D E F G H I J K L M N O P Q R a b c d e f g h i j k S l T U V W X Y Z A B C D m n o p q r s t u v w x y z a b E F G H I J K L M N O c d e f g h i j k l m P Q R S T U V W X Y Z A B C D E F G H I J K L M N O n o p P Q R S q r s t u v w x y z a b c d e f g h i j k l m n o p q r s t u v w x y z T U V W X Y Z 
 Termingating Program
</code></pre>
<p>由于此时的<code>goroutine</code>是并行运行的，所以大小写字母会混合在一起显示。</p>
<h2 id="竞争状态"><a class="markdownIt-Anchor" href="#竞争状态"></a> 竞争状态</h2>
<p>如果多个<code>goroutine</code>在没有互相同步的情况下，访问某个共享资源，并视图读和写这个资源时，就会相互竞争的状态，这种情况被称为竞争状态<code>race candition</code>。竞争状态的存在让并发程序变得复杂，而且容易引起问题。对于共享资源的读与写 必须是原子化的，即同一时刻只能有一个<code>goroutine</code>对共享资源进行读和写操作。</p>
<pre class="highlight"><code class="go"><span class="keyword">package</span> main

<span class="keyword">import</span> (
   <span class="string">"sync"</span>
   <span class="string">"runtime"</span>
   <span class="string">"fmt"</span>
)

<span class="keyword">var</span> (
   <span class="comment">// 共享资源</span>
   counter <span class="keyword">int</span>
   <span class="comment">// wg用于等待程序结束</span>
   wg sync.WaitGroup
)

<span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {
   wg.Add(<span class="number">2</span>)

   <span class="keyword">go</span> incCounter(<span class="number">1</span>)
   <span class="keyword">go</span> incCounter(<span class="number">2</span>)

   wg.Wait()
   fmt.Println(<span class="string">"Final Counter:"</span>, counter)
}

<span class="function"><span class="keyword">func</span> <span class="title">incCounter</span><span class="params">(id <span class="keyword">int</span>)</span></span>  {
   <span class="keyword">defer</span> wg.Done()

   <span class="keyword">for</span> count := <span class="number">0</span>; count &lt; <span class="number">2</span>; count++ {
      <span class="comment">// 捕获counter的值</span>
      value := counter
      <span class="comment">// 当前goroutine从线程退出，并放回到队列</span>
      runtime.Gosched()
      <span class="comment">// 本地value自增</span>
      value ++
      <span class="comment">// 将值保存回counter</span>
      counter = value
     
      <span class="comment">// 输出当前值</span>
      fmt.Printf(<span class="string">"%d - %d \n"</span>, id, counter)
   }
}
</code></pre>
<p>上述程序中，共享变量<code>counter</code>会进行4次读和写，每个<code>goroutine</code>会执行2次，但程序结束时，	<code>counter</code>的值却为2。程序执行过程如下图：</p>
<p><img src="/article/Go/Go Base/并发/%E7%AB%9E%E4%BA%89%E7%8A%B6%E6%80%81.png" alt="无法加载" title="竞争状态"></p>
<p>上述程序创建了两个<code>goroutine</code>,	<code>incCounter</code>函数对变量<code>counter</code>进行读和写操作，而该变量是共享资源。每个<code>goroutine</code>都会预先读出该变量的值，并将其副本存入到一个叫<code>value</code>的本地变量中，随后<code>incCounter</code>函数会对<code>value</code>的副本的值加1，最后将这个新值存到<code>counter</code>变量中。</p>
<p><code>runtime.Gosched()</code>会将当前<code>goroutine</code>从线程中退出，这样给了其他<code>goroutine</code>运行的机会。在本程序中，这样做的目的是强制调度器切换<code>goroutine</code>，使得竞争状态的效果更明显。</p>
<p>Go中有检测代码竞争状态的工具，执行<code>go build -race</code>,然后运行创建后的程序，可以看到:</p>
<pre class="highlight"><code class="shell">==================
WARNING: DATA RACE
Write at 0x0000005e09b0 by goroutine 7:
  main.incCounter()
      E:/GoProjects/src/demo/main.go:37 +0xb5

Previous read at 0x0000005e09b0 by goroutine 6:
  main.incCounter()
      E:/GoProjects/src/demo/main.go:31 +0x91

Goroutine 7 (running) created at:
  main.main()
      E:/GoProjects/src/demo/main.go:20 +0x90

Goroutine 6 (running) created at:
  main.main()
      E:/GoProjects/src/demo/main.go:19 +0x6f
==================
2 - 1
1 - 1
2 - 2
1 - 2
Final Counter: 2
Found 1 data race(s)
</code></pre>
<p>由上述竞争检测结果可知，竞争发生在<code>counter = value value: counter go incCounter(1) go incCounter(2)</code>这四行代码中。这几行分别是对<code>counter</code>的读和写操作。</p>
<p>要想消除竞争状态，可以使用Go语言提供的锁机制，来所住共享资源，从而保证<code>goroutine</code>的同步状态。</p>
<h2 id="锁住共享资源"><a class="markdownIt-Anchor" href="#锁住共享资源"></a> 锁住共享资源</h2>
<p>Go提供了传统的同步<code>goroutine</code>的机制，就是对共享资源加锁。如果需要顺序访问一个整型变量或一段代码，<code>atomic</code>和<code>sync</code>包中的函数提供了很好的解决方案。</p>
<h3 id="原子函数"><a class="markdownIt-Anchor" href="#原子函数"></a> 原子函数</h3>
<p><code>原子函数</code>能够以很底层的加锁机制来同步在访问整型变量和指针。</p>
<pre class="highlight"><code class="go"><span class="keyword">package</span> main

<span class="keyword">import</span> (
   <span class="string">"sync"</span>
   <span class="string">"runtime"</span>
   <span class="string">"fmt"</span>
   <span class="string">"sync/atomic"</span>
)

<span class="keyword">var</span> (
   <span class="comment">// 共享资源</span>
   counter <span class="keyword">int64</span>
   <span class="comment">// wg用于等待程序结束</span>
   wg sync.WaitGroup
)

<span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {
   wg.Add(<span class="number">2</span>)

   <span class="keyword">go</span> incCounter(<span class="number">1</span>)
   <span class="keyword">go</span> incCounter(<span class="number">2</span>)

   wg.Wait()
   fmt.Println(<span class="string">"Final Counter:"</span>, counter)
}

<span class="function"><span class="keyword">func</span> <span class="title">incCounter</span><span class="params">(id <span class="keyword">int</span>)</span></span>  {
   <span class="keyword">defer</span> wg.Done()

   <span class="keyword">for</span> count := <span class="number">0</span>; count &lt; <span class="number">2</span>; count++ {
      <span class="comment">// 安全地对counter+1</span>
      atomic.AddInt64(&amp;counter, <span class="number">1</span>)
      runtime.Gosched()
   }
}
</code></pre>
<p>上述程序使用<code>atomic</code>的<code>AddInt64</code>函数，这个函数会同步整型值的加法，通过强制同一时刻只能有一个<code>goroutine</code>运行并完成加法操作。当<code>goroutine</code>试图去调用任何原子函数时，这些<code>goroutine</code>都会自动根据所引用的变量做同步处理。</p>
<p>此外 还有两个函数<code>LoadInt64</code>和<code>StoreInt64</code>，这两个原子函数提供安全地读和写一个整型值的方式。下述程序将使用这两个函数创建一个同步标志，该标志可以向程序里多个	<code>goroutine</code>通知某种特殊状态。</p>

        
                <blockquote style="margin: 2em 0 0;padding: 0.5em 1em;border-left: 3px solid #F44336;background-color: #F5F5F5;list-style: none;">
                    <p><strong>
                         
                            This blog is under a <a href="/creativecommons.html" target="_blank">CC BY-NC-SA 3.0 Unported License</a>
                        </strong>
                        <br>
                        <strong>本文链接：</strong><a href="http://yov.oschina.io/article/Go/Go Base/并发/">http://yov.oschina.io/article/Go/Go Base/并发/</a>
                    </p>
                </blockquote>
        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <!-- 使用 gitcoment -->
<div id="gitment-comment">
    <!-- Gitment 评论框 -->
<div id="container"></div>
</div>
<style>
    #gitment-comment{
        background-color: #eee;
        padding: 2pc;
    }
</style>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
    var gitment = new Gitment({
        //id: '页面 ID', // 可选。默认为 location.href
        owner: 'youyouvi',
        repo: 'youyouvi.github.io',
        oauth: {
            client_id: 'fdcff2e0ff2fdfecce93',
            client_secret: 'c0cf25fd016b2c8831a622a292a3692daa54c73a',
        },
    })
    gitment.render('container')
</script>

                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/article/Java/Java/Java知识(五)/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/article/Go/Go Base/数组、切片和映射/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/head.jpg" alt="子语's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        yo.vi@foxmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=HGVzMmp1XHpzZHF9dXAyf3Nx" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2018/01/">一月 2018<span class="sidebar_archives-count">14</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/12/">十二月 2017<span class="sidebar_archives-count">9</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/11/">十一月 2017<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/10/">十月 2017<span class="sidebar_archives-count">14</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/09/">九月 2017<span class="sidebar_archives-count">14</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/Go/">Go<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/categories/Java/">Java<span class="sidebar_archives-count">25</span></a></li><li><a class="sidebar_archives-link" href="/categories/博客搭建/">博客搭建<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/容器/">容器<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/categories/工具/">工具<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/categories/微服务/">微服务<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/categories/框架/">框架<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/categories/测试/">测试<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/语言/">语言<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
        
            <li class="divider"></li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/tags" title="标签">
                
                    <i class="material-icons sidebar-material-icons">cloud</i>
                
                标签
            </a>
        </li>
        
    
        <li>
            <a href="/timeline" title="时间轴">
                
                    <i class="material-icons sidebar-material-icons">timeline</i>
                
                时间轴
            </a>
        </li>
        
    
        <li>
            <a href="/about" title="关于我">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                关于我
            </a>
        </li>
        
    
        <li>
            <a href="/links" title="友情链接">
                
                    <i class="material-icons sidebar-material-icons">links</i>
                
                友情链接
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">54</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->


<!-- Theme Material -->


<!-- Help & Support -->
<!--

    <a href="mailto:hiviosey@gmail.com" class="sidebar-footer-text-a">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
        sidebar.help
        <span class="mdl-button__ripple-container">
          <span class="mdl-ripple"></span>
        </span>
      </div>
    </a>

-->

<!-- Feedback -->
<!--

    <a href="https://github.com/viosey/hexo-theme-material/issues" target="_blank" class="sidebar-footer-text-a">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
        sidebar.feedback
        <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
    </a>

-->

<!-- About Theme -->
<!--

    <a href="https://blog.viosey.com/index.php/Material.html" target="_blank" class="sidebar-footer-text-a">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
             sidebar.about_theme
            <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
    </a>

-->

    </div>

    <!-- Sidebar Image -->
    
    <span id="footer-image">
        <a href="https://www.upyun.com/" target="_blank" title="upyun_logo">
            <img src="/img/upyun_logo.svg" alt="upyun_logo"><!--
     --></a>
    </span>


</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/youyouvi" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    
        <a href="https://www.linkedin.com" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-linkedin">
                <span class="visuallyhidden">LinkedIn</span>
            </button><!--
     --></a>
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
    
    <!-- V2EX -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>Ember
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <!--<div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>-->
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?V/53wGualMuiPM3xoetD5Q==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>







    <!-- Busuanzi -->
    <script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



   <!-- Gitment -->





<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->

    
        
            <script>lsloader.load("prettify_js","/js/prettify.min.js?WN07fivHQSMKWy7BmHBB6w==", true)</script>
        
    



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
        
            $(function() {
                $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto;');
                prettyPrint();
                })
        
    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.0 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
