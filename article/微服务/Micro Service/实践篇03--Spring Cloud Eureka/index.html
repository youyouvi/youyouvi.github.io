<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.0 -->
    <script>
        window.materialVersion = "1.5.0"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">



    <link rel="dns-prefetch" href="https://busuanzi.ibruce.info"/>












    <!-- Title -->
    
    <title>
        
            实践篇03--Spring Cloud Eureka | 
        
        Ember
    </title>

    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="format-detection" content="telephone=no"/>
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="子语">
    <meta name="description" itemprop="description" content="一切有为法,如梦幻泡影。如露亦如电,应作如是观。">
    <meta name="keywords" content="Blog,微服务">

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(key){try{localStorage.removeItem(key)}catch(e){}};lsloader.setLS=function(key,val){try{localStorage.setItem(key,val)}catch(e){}};lsloader.getLS=function(key){var val="";try{val=localStorage.getItem(key)}catch(e){val=""}return val};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var keys=[];for(var i=0;i<localStorage.length;i++){keys.push(localStorage.key(i))}keys.forEach(function(key){var data=lsloader.getLS(key);if(window.oldVersion){var remove=window.oldVersion.reduce(function(p,c){return p||data.indexOf("/*"+c+"*/")!==-1},false);if(remove){lsloader.removeLS(key)}}})}catch(e){}};lsloader.clean();lsloader.load=function(jsname,jspath,cssonload,isJs){if(typeof cssonload==="boolean"){isJs=cssonload;cssonload=undefined}isJs=isJs||false;cssonload=cssonload||function(){};var code;code=this.getLS(jsname);if(code&&code.indexOf(versionString)===-1){this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload,isJs);return}if(code){var versionNumber=code.split(versionString)[0];if(versionNumber!=jspath){console.log("reload:"+jspath);this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload,isJs);return}code=code.split(versionString)[1];if(isJs){this.jsRunSequence.push({name:jsname,code:code});this.runjs(jspath,jsname,code)}else{document.getElementById(jsname).appendChild(document.createTextNode(code));cssonload()}}else{this.requestResource(jsname,jspath,cssonload,isJs)}};lsloader.requestResource=function(name,path,cssonload,isJs){var that=this;if(isJs){this.iojs(path,name,function(path,name,code){that.setLS(name,path+versionString+code);that.runjs(path,name,code)})}else{this.iocss(path,name,function(code){document.getElementById(name).appendChild(document.createTextNode(code));that.setLS(name,path+versionString+code)},cssonload)}};lsloader.iojs=function(path,jsname,callback){var that=this;that.jsRunSequence.push({name:jsname,code:""});try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(path,jsname,xhr.response);return}}that.jsfallback(path,jsname)}};xhr.send(null)}catch(e){that.jsfallback(path,jsname)}};lsloader.iocss=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.iofonts=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.runjs=function(path,name,code){if(!!name&&!!code){for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code=code}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var script=document.createElement("script");script.appendChild(document.createTextNode(this.jsRunSequence[0].code));script.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(script);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var that=this;var script=document.createElement("script");script.src=this.jsRunSequence[0].path;script.type="text/javascript";this.jsRunSequence[0].status="loading";script.onload=function(){that.jsRunSequence.shift();if(that.jsRunSequence.length>0){that.runjs()}};document.body.appendChild(script)}};lsloader.tagLoad=function(path,name){this.jsRunSequence.push({name:name,code:"",path:path,status:"failed"});this.runjs()};lsloader.jsfallback=function(path,name){if(!!this.jsnamemap[name]){return}else{this.jsnamemap[name]=name}for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code="";this.jsRunSequence[k].status="failed";this.jsRunSequence[k].path=path}}this.runjs()};lsloader.cssfallback=function(path,name,cssonload){if(!!this.cssnamemap[name]){return}else{this.cssnamemap[name]=1}var link=document.createElement("link");link.type="text/css";link.href=path;link.rel="stylesheet";link.onload=link.onerror=cssonload;var root=document.getElementsByTagName("script")[0];root.parentNode.insertBefore(link,root)};lsloader.runInlineScript=function(scriptId,codeId){var code=document.getElementById(codeId).innerText;this.jsRunSequence.push({name:scriptId,code:code});this.runjs()};lsloader.loadCombo=function(jslist){var updateList="";var requestingModules={};for(var k in jslist){var LS=this.getLS(jslist[k].name);if(!!LS){var version=LS.split(versionString)[0];var code=LS.split(versionString)[1]}else{var version=""}if(version==jslist[k].path){this.jsRunSequence.push({name:jslist[k].name,code:code,path:jslist[k].path})}else{this.jsRunSequence.push({name:jslist[k].name,code:null,path:jslist[k].path,status:"comboloading"});requestingModules[jslist[k].name]=true;updateList+=(updateList==""?"":";")+jslist[k].path}}var that=this;if(!!updateList){var xhr=new XMLHttpRequest;xhr.open("get",combo+updateList,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){that.runCombo(xhr.response,requestingModules);return}}else{for(var i in that.jsRunSequence){if(requestingModules[that.jsRunSequence[i].name]){that.jsRunSequence[i].status="failed"}}that.runjs()}}};xhr.send(null)}this.runjs()};lsloader.runCombo=function(comboCode,requestingModules){comboCode=comboCode.split("/*combojs*/");comboCode.shift();for(var k in this.jsRunSequence){if(!!requestingModules[this.jsRunSequence[k].name]&&!!comboCode[0]){this.jsRunSequence[k].status="comboJS";this.jsRunSequence[k].code=comboCode[0];this.setLS(this.jsRunSequence[k].name,this.jsRunSequence[k].path+versionString+comboCode[0]);comboCode.shift()}}this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/fa.png">
    <link rel="icon" sizes="192x192" href="/img/fa.png">
    <link rel="apple-touch-icon" href="/img/mao.png">

    <!--iOS -->
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Ember">

    <!-- Site Verification -->
    
    <meta name="baidu-site-verification" content="k8tNw6G5YO" />

    <!-- RSS -->
    

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?MKetZV3cUTfDxvMffaOezg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        
            
                <style id="prettify_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_css","/css/prettify.min.css?zp8STOU9v89XWFEnN+6YmQ==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
                <style id="prettify_theme"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_theme","/css/prettify/tomorrow-night-eighties.min.css?2LJQzURO+Kr8r/fl/T8oMA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
            
        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #000000 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #000000 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #000000 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-image: url(/img/bg6.jpg);
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.proxy.ustclug.org/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icon -->

    <link href="https://fonts.proxy.ustclug.org/icon?family=Material+Icons" rel="stylesheet">




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==", true)</script>
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://yov.oschina.io">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="实践篇03--Spring Cloud Eureka | Ember">
    <meta property="og:image" content="http://yov.oschina.io/img/fa.png" />
    <meta property="og:description" content="一切有为法,如梦幻泡影。如露亦如电,应作如是观。">
    <meta property="og:article:tag" content="微服务"> 

    
        <meta property="article:published_time" content="Mon Jan 15 2018 22:06:20 GMT+0800" />
        <meta property="article:modified_time" content="Thu Jan 18 2018 15:42:52 GMT+0800" />
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:title" content="实践篇03--Spring Cloud Eureka | Ember">
    <meta name="twitter:description" content="一切有为法,如梦幻泡影。如露亦如电,应作如是观。">
    <meta name="twitter:image" content="http://yov.oschina.io/img/fa.png">
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="http://yov.oschina.io" />

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://yov.oschina.io/article/微服务/Micro Service/实践篇03--Spring Cloud Eureka/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "http://yov.oschina.io/article/微服务/Micro Service/实践篇03--Spring Cloud Eureka/index.html",
    "headline": "实践篇03--Spring Cloud Eureka",
    "datePublished": "Mon Jan 15 2018 22:06:20 GMT+0800",
    "dateModified": "Thu Jan 18 2018 15:42:52 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "子语",
        "image": {
            "@type": "ImageObject",
            "url": "/img/head.jpg"
        },
        "description": "一切有为法,如梦幻泡影.如露亦如电,应作如是观."
    },
    "publisher": {
        "@type": "Organization",
        "name": "Ember",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/fa.png"
        }
    },
    "keywords": ",微服务Blog",
    "description": "一切有为法,如梦幻泡影。如露亦如电,应作如是观。",
}
</script>


    

    <!-- Analytics -->
    
    
    

    <!-- Custom Head -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#服务治理"><span class="post-toc-number">1.</span> <span class="post-toc-text"> 服务治理</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#netflix-eureka"><span class="post-toc-number">2.</span> <span class="post-toc-text"> Netflix Eureka</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#搭建服务注册中心"><span class="post-toc-number">2.1.</span> <span class="post-toc-text"> 搭建服务注册中心</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#构建服务"><span class="post-toc-number">2.2.</span> <span class="post-toc-text"> 构建服务</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#高可用注册中心"><span class="post-toc-number">2.3.</span> <span class="post-toc-text"> 高可用注册中心</span></a></li></ol></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                实践篇03--Spring Cloud Eureka
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/head.jpg" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>子语</strong>
        <span>2018 - 01 - 15</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    
        <button id="article-functions-qrcode-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">devices other</i>
    <span class="visuallyhidden">devices other</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-qrcode-button">
    <li class="mdl-menu__item">在其它设备中阅读本文章</li>
    
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQ4AAAEOCAAAAABd2qZ5AAADhUlEQVR42u3aS25bMRAEQN3/0s42gCO5e4aUFaDeKnCUZ7K06Mzn8eX563kgwIEDBw4cOHDgwIHjgzke8ZP/q2efSX6en+ofF5vdBQcOHDhwXOD4IYpGn3l21e9HT97zmnV1Thw4cODAcY2jjcDX136MntfxuYlqHDhw4MDx+Ryz8Ju9OQ9vHDhw4MDxP3LkQdgWY3lUvy7PcODAgQPHJ3AkDbV8HJX8/HBkvr9XigMHDhw41gsNn//nt+534MCBAweObxzt05ZSCf1sJSIP1x9uhAMHDhw4jnLMmnFtI68t0jZjp7yZiAMHDhw4bnDko6P9IGo2fJqdsEDEgQMHDhwXOGYhOmNKBlFtuZjT1BUtDhw4cOA41BzMF+ASsmK9YLGyMFxxwIEDBw4cRzlOLRC0sZcXcnmQD+McBw4cOHBc45gtCuThl7T88ve047FicxAHDhw4cFzgmA2QijWCQ+Ha/nYcOHDgwHGbY1MOtSsL7WApHyPNlu1w4MCBA8d7ODbDnraRV5dbizDGgQMHDhzv5GhHSnkxNovV2dcwPD8OHDhw4DjK0a6+tY2//c8T3NkqAw4cOHDguMHRHqIl29Pk63SzYhIHDhw4cNzgyI+eh1l7jeHQKKZ/+rc4cODAgeMoR1LkbMqtJDhn6wvtQsOqOYgDBw4cOBZjp31AzkZHbZTOWopFcxAHDhw4cCw49oXZ2aJuA4QDBw4cOH6Xox3znGrzJV9GW5gNW4c4cODAgePtHLM2XH7VaO0gIGjfiQMHDhw4bnDcWEFoyU59PV+jBwcOHDhw3OBoy7Y2/NqoTtqO7WJEEbQ4cODAgWNdwm2GTHmTbg+UnOpAcxAHDhw4cByds7SLdHu+9jyzQvHpb8SBAwcOHG/hSF40a8/l46V8BHVxCocDBw4cOBYc7SrDZoCUI+YLcLMRFA4cOHDguMfRBlte4CUXyAdRp5YncODAgQPHDY72udHOayM/L0EjYhw4cODAcZSjDa22PEsiMykpkze0bUEcOHDgwHGP4z2DoryEi64RtDJx4MCBA8fvcrTFVTvgaS/TniTBLVblcODAgQPHGzlmA6r8oG18toMxHDhw4MDxaRw3PtkOvY6Vgjhw4MCB4xpHuzSQLxbsVxxmcRu9DQcOHDhwXOBoW2yzqJst1eX/LTgWtDhw4MCBY8HhwYEDBw4cOHDgwIEDx4c9fwBZ7tfx8StoJAAAAABJRU5ErkJggg==">
    
</ul>

    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/微服务/">微服务</a>
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    
        
            <!-- Busuanzi Views -->
            <a class="post_share-link" href="#">
                <li class="mdl-menu__item">
                    <span id="busuanzi_container_page_pv">
                        <span id="busuanzi_value_page_pv"></span>&nbsp;浏览量
                    </span>
                </li>
            </a>
        
    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=实践篇03--Spring Cloud Eureka&url=http://yov.oschina.io/article/微服务/Micro Service/实践篇03--Spring Cloud Eureka/index.html&pic=http://yov.oschina.io/img/fa.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    

    <!-- Share Facebook -->
    

    <!-- Share Google+ -->
    

    <!-- Share LinkedIn -->
    
        <a class="post_share-link" href="https://www.linkedin.com/shareArticle?mini=true&url=http://yov.oschina.io/article/微服务/Micro Service/实践篇03--Spring Cloud Eureka/index.html&title=实践篇03--Spring Cloud Eureka" target="_blank">
            <li class="mdl-menu__item">
                分享到 LinkedIn
            </li>
        </a>
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=Ember&title=实践篇03--Spring Cloud Eureka&summary=一切有为法,如梦幻泡影。如露亦如电,应作如是观。&pics=http://yov.oschina.io/img/fa.png&url=http://yov.oschina.io/article/微服务/Micro Service/实践篇03--Spring Cloud Eureka/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Telegram -->
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <p><code>Spring Cloud Eureka</code>是<code>Spring Cloud Netflix</code>微服务套件中的一部分，它基于<code>Netflix Eureka</code>的二次封装，主要是负责完成微服务架构的服务治理能力。我们只需通过简单引入依赖和注解配置就能使<code>Spring Boot</code>构建的微服务应用轻松地与Eureka服务治理体系进行整合。下面将构建用于服务治理的基础设施：</p>
<ul>
<li>构建服务注册中心</li>
<li>服务注册与服务发现</li>
<li>Eureka的基础架构</li>
<li>Eureka的服务治理机制</li>
<li>Eureka的配置</li>
</ul>
<h2 id="服务治理"><a class="markdownIt-Anchor" href="#服务治理"></a> 服务治理</h2>
<p>服务治理是微服务架构中最为核心和基础的模块，主要用于实现各个微服务实例的自动化注册与发现。随着业务的发展、功能的复杂、微服务应用的增加，静态配置维护难度会递增，且面对不断发展的业务，集群规模、服务位置和命名都有可能改变，手工维护的方式容易导致错误和冲突。</p>
<p>因此为了解决微服务架构中实例维护问题，出现了许多服务治理框架和产品，他们的实现主要都围绕着服务注册与服务发现机制来实现对微服务应用实例的自动化管理。</p>
<ul>
<li>服务注册：在服务治理框架中，会构建一个注册中心，每个服务向注册中心登记自己提供的服务，将主机、端口号、通信协议等信息告知。注册中心会在服务启动和注册后，维护一个服务清单，并以心跳的方式检测清单中的服务是否可用，若不可用则剔除，以达到排除故障的效果。</li>
<li>服务发现：由于在服务治理框架下运作，服务间的调用不再通过指定具体的实例地址来发现，而是通过向服务名发起请求调用实现。所以，服务调用放在调用服务提供方接口时，并不知道具体的服务实例位置。因此调用发需要向服务注册中心咨询服务，并获取所有的服务的实例清单，以实现对具体服务实例的访问。</li>
</ul>
<h2 id="netflix-eureka"><a class="markdownIt-Anchor" href="#netflix-eureka"></a> Netflix Eureka</h2>
<p><code>Spring Cloud Eureka</code>,使用<code>Netflix Eureka</code>实现服务注册与发现，既包含服务端组件，也包含客户端组件，提供了完备的RESTful API，支持将非Java语言构建的微服务纳入其服务治理体系中。</p>
<p>Eureka服务端，也称为服务注册中心，支持高可用配置，依托于强一致性提供良好的服务实例可用性，可以应对多重不同的故障场景。当Eureka以集群模式部署，集群中有分片出现故障时，Eureka会转入自动保护模式。它允许分片故障期间继续提供服务的发现和注册，当故障分片回复运行时，集群中其它分片会它们的状态再次同步回来。</p>
<p>Eureka客户端，主要处理服务的注册与发现。客户端服务通过注解和参数配置的方式，嵌入到客户端应用程序的代码中，当应用程序运行时，客户端向注册中心注册自身的提供的服务，并周期性地发送心跳来更新它的服务租约。同时它也能从服务端查询当前注册的服务信息并将它们缓存到本地并周期地刷新服务状态。</p>
<h3 id="搭建服务注册中心"><a class="markdownIt-Anchor" href="#搭建服务注册中心"></a> 搭建服务注册中心</h3>
<p>创建一个Spring Boot工程<code>enreka-server</code>，在<code>pom.xml</code>中引入相关依赖：</p>
<pre class="highlight"><code class="xml"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span>
<span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>
   <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span>
   <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span>

   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.example<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
   <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span>
   <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span>

   <span class="tag">&lt;<span class="name">name</span>&gt;</span>eureka-server<span class="tag">&lt;/<span class="name">name</span>&gt;</span>
   <span class="tag">&lt;<span class="name">description</span>&gt;</span>Demo project for Spring Boot<span class="tag">&lt;/<span class="name">description</span>&gt;</span>

   <span class="tag">&lt;<span class="name">parent</span>&gt;</span>
      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span>
      <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span>
   <span class="tag">&lt;/<span class="name">parent</span>&gt;</span>

   <span class="tag">&lt;<span class="name">properties</span>&gt;</span>
      <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span>
      <span class="tag">&lt;<span class="name">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.reporting.outputEncoding</span>&gt;</span>
      <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span>
      <span class="tag">&lt;<span class="name">spring-cloud.version</span>&gt;</span>Edgware.RELEASE<span class="tag">&lt;/<span class="name">spring-cloud.version</span>&gt;</span>
   <span class="tag">&lt;/<span class="name">properties</span>&gt;</span>

   <span class="comment">&lt;!-- eureka服务依赖 --&gt;</span>
   <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span>
      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span>
         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>
   <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span>

   <span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span>
      <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span>
         <span class="tag">&lt;<span class="name">dependency</span>&gt;</span>
            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">version</span>&gt;</span>${spring-cloud.version}<span class="tag">&lt;/<span class="name">version</span>&gt;</span>
            <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span>
            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span>
         <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>
      <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span>
   <span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span>

   <span class="tag">&lt;<span class="name">build</span>&gt;</span>
      <span class="tag">&lt;<span class="name">plugins</span>&gt;</span>
         <span class="tag">&lt;<span class="name">plugin</span>&gt;</span>
            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
         <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span>
      <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span>
   <span class="tag">&lt;/<span class="name">build</span>&gt;</span>

<span class="tag">&lt;/<span class="name">project</span>&gt;</span>
</code></pre>
<p>在项目启动器中添加<code>@EnableEurekaServer</code>注解启动一个服务注册中心提供给其他应用进行对话。</p>
<pre class="highlight"><code class="java"><span class="keyword">package</span> com.example.eurekaserver;

<span class="keyword">import</span> org.springframework.boot.SpringApplication;
<span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;
<span class="keyword">import</span> org.springframework.cloud.netflix.eureka.server.EnableEurekaServer;

<span class="meta">@EnableEurekaServer</span>
<span class="meta">@SpringBootApplication</span>
<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EurekaServerApplication</span> </span>{
   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{
      SpringApplication.run(EurekaServerApplication.class, args);
   }
}

</code></pre>
<p>默认情况下，该服务注册中心也会将自己作为客户端进行注册。可在配置文件<code>application.yml</code>中禁用该项:</p>
<pre class="highlight"><code class="yaml"><span class="attr">spring:</span>
<span class="attr">  application:</span>
<span class="attr">    name:</span> <span class="string">Eureka-Server</span>
<span class="attr">server:</span>
<span class="attr">  port:</span> <span class="number">10000</span>
<span class="attr">eureka:</span>
<span class="attr">  instance:</span>
<span class="attr">    hostname:</span> <span class="string">localhost</span>
<span class="attr">  client:</span>
<span class="attr">    register-with-eureka:</span> <span class="literal">false</span> <span class="comment"># 不向注册中心注册自己</span>
<span class="attr">    fetch-registry:</span> <span class="literal">false</span>  <span class="comment"># 注册中心的职责是维护服务实例，不需要检索服务</span>
</code></pre>
<p>启动应用，并访问<code>http://localhost:10000</code>，界面如下：</p>
<p><img src="/article/微服务/Micro Service/实践篇03--Spring Cloud Eureka/eureka-server.png" alt="无法加载" title="服务注册中心"></p>
<p>此时可见<code>Instances currently registered with Eureka</code>为空，这是因为还没有服务向注册中心注册。</p>
<h3 id="构建服务"><a class="markdownIt-Anchor" href="#构建服务"></a> 构建服务</h3>
<p>接下来构建一个微服务向服务中心注册自己。新建Spring Boot项目<code>eureka-client</code>，在<code>pom.xml</code>添加依赖：</p>
<pre class="highlight"><code class="xml"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span>
<span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>
   <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span>
   <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span>

   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.example<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
   <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span>
   <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span>

   <span class="tag">&lt;<span class="name">name</span>&gt;</span>eureka-client<span class="tag">&lt;/<span class="name">name</span>&gt;</span>
   <span class="tag">&lt;<span class="name">description</span>&gt;</span>Demo project for Spring Boot<span class="tag">&lt;/<span class="name">description</span>&gt;</span>

   <span class="tag">&lt;<span class="name">parent</span>&gt;</span>
      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span>
      <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span>
   <span class="tag">&lt;/<span class="name">parent</span>&gt;</span>

   <span class="tag">&lt;<span class="name">properties</span>&gt;</span>
      <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span>
      <span class="tag">&lt;<span class="name">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.reporting.outputEncoding</span>&gt;</span>
      <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span>
      <span class="tag">&lt;<span class="name">spring-cloud.version</span>&gt;</span>Edgware.RELEASE<span class="tag">&lt;/<span class="name">spring-cloud.version</span>&gt;</span>
   <span class="tag">&lt;/<span class="name">properties</span>&gt;</span>

   <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span>
      <span class="comment">&lt;!-- 添加Eureka依赖 --&gt;</span>
      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span>
         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-eureka<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>
      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span>
         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>

      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span>
         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
         <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span>
      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>
   <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span>

   <span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span>
      <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span>
         <span class="tag">&lt;<span class="name">dependency</span>&gt;</span>
            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">version</span>&gt;</span>${spring-cloud.version}<span class="tag">&lt;/<span class="name">version</span>&gt;</span>
            <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span>
            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span>
         <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>
      <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span>
   <span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span>

   <span class="tag">&lt;<span class="name">build</span>&gt;</span>
      <span class="tag">&lt;<span class="name">plugins</span>&gt;</span>
         <span class="tag">&lt;<span class="name">plugin</span>&gt;</span>
            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
         <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span>
      <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span>
   <span class="tag">&lt;/<span class="name">build</span>&gt;</span>

<span class="tag">&lt;/<span class="name">project</span>&gt;</span>
</code></pre>
<p>添加<code>/hello</code>接口，通过注入<code>DiscoveryClient</code>对象，在日志中输出服务的相关信息。</p>
<pre class="highlight"><code class="java"><span class="keyword">package</span> com.example.eurekaclient;

<span class="keyword">import</span> org.apache.log4j.Logger;
<span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="keyword">import</span> org.springframework.cloud.client.discovery.DiscoveryClient;
<span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;
<span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;

<span class="comment">/**
 * <span class="doctag">@author</span> Yov
 * <span class="doctag">@date</span> 2018/1/14 20:10
 */</span>
<span class="meta">@RestController</span>
<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> </span>{
    <span class="keyword">private</span> <span class="keyword">final</span> Logger logger = Logger.getLogger(getClass());

    <span class="meta">@Autowired</span>
    <span class="keyword">private</span> DiscoveryClient discoveryClient; <span class="comment">// 用于获取服务</span>

    <span class="meta">@GetMapping</span>(<span class="string">"/hello"</span>)
    <span class="function"><span class="keyword">public</span> String <span class="title">index</span><span class="params">()</span> </span>{
        discoveryClient.getServices().forEach(id -&gt; {
            discoveryClient.getInstances(id).forEach(instance -&gt; {
                <span class="comment">// 在日志中输出服务的相关信息</span>
                logger.info(<span class="string">"Hello, host:"</span> + instance.getHost() +
                        <span class="string">", server_id: "</span> + instance.getServiceId());
            });
        });
        <span class="keyword">return</span> <span class="string">"Hello World!"</span>;
    }
}

</code></pre>
<p>在程序入口添加<code>@EnableDiscoveryClient</code>注解，激活Eureka中的<code>DiscoveryClient</code>(自动化配置，创建<code>DiscoveryClient</code>接口针对Eureka的<code>EnrekaDiscoveryClient</code>实例)，这样才能实现Controller中对服务信息的输出。</p>
<pre class="highlight"><code class="java"><span class="keyword">package</span> com.example.eurekaclient;

<span class="keyword">import</span> org.springframework.boot.SpringApplication;
<span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;
<span class="keyword">import</span> org.springframework.cloud.client.discovery.EnableDiscoveryClient;

<span class="meta">@EnableDiscoveryClient</span>
<span class="meta">@SpringBootApplication</span>
<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EurekaClientApplication</span> </span>{

   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{
      SpringApplication.run(EurekaClientApplication.class, args);
   }
}
</code></pre>
<p>修改配置文件<code>application.yml</code></p>
<pre class="highlight"><code class="yaml"><span class="attr">spring:</span>
<span class="attr">  application:</span>
<span class="attr">    name:</span> <span class="string">hello-service</span>  <span class="comment"># 为服务命名</span>
<span class="attr">eureka:</span>
<span class="attr">  client:</span>
<span class="attr">    service-url:</span>
<span class="attr">      defaultZone:</span> <span class="attr">http://localhost:10000/eureka</span> <span class="comment"># 为服务指定注册中心</span>
<span class="attr">server:</span>
<span class="attr">  port:</span> <span class="number">10001</span>
</code></pre>
<p>启动服务后，可以在<code>eureka-client</code>控制台看到如下信息：</p>
<pre class="highlight"><code class="verilog">Registering application hello-service <span class="keyword">with</span> eureka <span class="keyword">with</span> status UP
Saw <span class="keyword">local</span> status change <span class="keyword">event</span> StatusChangeEvent [timestamp=<span class="number">1516155585227</span>, current=UP, previous=STARTING]
DiscoveryClient_HELLO-SERVICE/youw:hello-service:<span class="number">10001</span>: registering service...
DiscoveryClient_HELLO-SERVICE/youw:hello-service:<span class="number">10001</span> - registration status: <span class="number">204</span>
Tomcat started on port(s): <span class="number">10001</span> (http)
Updating port to <span class="number">10001</span>
</code></pre>
<p>当访问该服务时，会出现控制台输出如下信息：<code>Hello, host:youw, server_id: HELLO-SERVICE</code>。</p>
<p>在<code>eureka-server</code>控制台可看到如下信息：<code>Registered instance HELLO-SERVICE/youw:hello-service:10001 with status UP (replication=false)</code>。访问<code>http://localhost:10000</code>，此时可见<code>Instances currently registered with Eureka</code>为增加了一个服务：<code>HELLO-SERVICE</code>。</p>
<h3 id="高可用注册中心"><a class="markdownIt-Anchor" href="#高可用注册中心"></a> 高可用注册中心</h3>
<p>在微服务这样分布式的环境中，需要充分考虑发生故障的情况，所以在生产环节需要对各个组件进行高可用部署。Eureka Server充分考虑了这一点，每一个节点既可以是服务提供者，也可以是服务消费者。服务注册中心也可以向其他服务注册自身。</p>
<p>新建一个项目<code>eureka-center</code>，作为另一个服务注册中心，参照<code>enreka-server</code>，但要修改<code>application.qml</code>文件:</p>
<pre class="highlight"><code class="yaml"><span class="attr">server:</span>
<span class="attr">  port:</span> <span class="number">20000</span>
<span class="attr">spring:</span>
<span class="attr">  application:</span>
<span class="attr">    name:</span> <span class="string">eureka-server</span>
<span class="attr">eureka:</span>
<span class="attr">  instance:</span>
<span class="attr">    hostname:</span> <span class="string">center</span>
<span class="attr">  client:</span>
<span class="attr">    service-url:</span>
<span class="attr">      defaultZone:</span> <span class="attr">http://localhost:10000/eureka/</span> <span class="comment"># 指向注册中心</span>
</code></pre>
<p>修改<code>eureka-server</code>的<code>application.yml</code>启动:</p>
<pre class="highlight"><code class="yaml"><span class="attr">spring:</span>
<span class="attr">  application:</span>
<span class="attr">    name:</span> <span class="string">eureka-Server</span>
<span class="attr">server:</span>
<span class="attr">  port:</span> <span class="number">10000</span>
<span class="attr">eureka:</span>
<span class="attr">  instance:</span>
<span class="attr">    hostname:</span> <span class="string">localhost</span>
<span class="attr">  client:</span>
<span class="attr">    service-url:</span>
<span class="attr">      defaultZone:</span> <span class="attr">http://center:20000/eureka/</span> <span class="comment"># 指向注册中心</span>
</code></pre>
<p>修改<code>eureka-client</code>的<code>application.yml</code></p>
<pre class="highlight"><code class="yaml"><span class="attr">spring:</span>
<span class="attr">  application:</span>
<span class="attr">    name:</span> <span class="string">hello-service</span>  <span class="comment"># 为服务命名</span>
<span class="attr">eureka:</span>
<span class="attr">  client:</span>
<span class="attr">    service-url:</span>
      <span class="comment"># 同时向两个注册中心注册自己</span>
<span class="attr">      defaultZone:</span> <span class="attr">http://localhost:10000/eureka/,http://center:20000/eureka/</span>
<span class="attr">server:</span>
<span class="attr">  port:</span> <span class="number">10001</span>
</code></pre>
<p>其实启动三个应用程序，访问两个注册中心，均能看到：</p>
<p><img src="/article/微服务/Micro Service/实践篇03--Spring Cloud Eureka/%E9%AB%98%E5%8F%AF%E7%94%A8.png" alt="无法加载" title="高可用服务注册中心"></p>
<p>此时两个注册中心即使有一个中断了，在另一个注册中心的服务依然可以访问<code>hello-server</code>。</p>

        
                <blockquote style="margin: 2em 0 0;padding: 0.5em 1em;border-left: 3px solid #F44336;background-color: #F5F5F5;list-style: none;">
                    <p><strong>
                         
                            This blog is under a <a href="/creativecommons.html" target="_blank">CC BY-NC-SA 3.0 Unported License</a>
                        </strong>
                        <br>
                        <strong>本文链接：</strong><a href="http://yov.oschina.io/article/微服务/Micro Service/实践篇03--Spring Cloud Eureka/">http://yov.oschina.io/article/微服务/Micro Service/实践篇03--Spring Cloud Eureka/</a>
                    </p>
                </blockquote>
        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <!-- 使用 gitcoment -->
<div id="gitment-comment">
    <!-- Gitment 评论框 -->
<div id="container"></div>
</div>
<style>
    #gitment-comment{
        background-color: #eee;
        padding: 2pc;
    }
</style>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
    var gitment = new Gitment({
        //id: '页面 ID', // 可选。默认为 location.href
        owner: 'youyouvi',
        repo: 'youyouvi.github.io',
        oauth: {
            client_id: 'fdcff2e0ff2fdfecce93',
            client_secret: 'c0cf25fd016b2c8831a622a292a3692daa54c73a',
        },
    })
    gitment.render('container')
</script>

                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/article/Go/Go Base/Go中的类型/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/article/Go/Go Base/打包和工具链/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/head.jpg" alt="子语's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        yo.vi@foxmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=HGVzMmp1XHpzZHF9dXAyf3Nx" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2018/01/">一月 2018<span class="sidebar_archives-count">14</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/12/">十二月 2017<span class="sidebar_archives-count">9</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/11/">十一月 2017<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/10/">十月 2017<span class="sidebar_archives-count">14</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/09/">九月 2017<span class="sidebar_archives-count">14</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/Go/">Go<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/categories/Java/">Java<span class="sidebar_archives-count">25</span></a></li><li><a class="sidebar_archives-link" href="/categories/博客搭建/">博客搭建<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/容器/">容器<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/categories/工具/">工具<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/categories/微服务/">微服务<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/categories/框架/">框架<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/categories/测试/">测试<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/语言/">语言<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
        
            <li class="divider"></li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/tags" title="标签">
                
                    <i class="material-icons sidebar-material-icons">cloud</i>
                
                标签
            </a>
        </li>
        
    
        <li>
            <a href="/timeline" title="时间轴">
                
                    <i class="material-icons sidebar-material-icons">timeline</i>
                
                时间轴
            </a>
        </li>
        
    
        <li>
            <a href="/about" title="关于我">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                关于我
            </a>
        </li>
        
    
        <li>
            <a href="/links" title="友情链接">
                
                    <i class="material-icons sidebar-material-icons">links</i>
                
                友情链接
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">54</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->


<!-- Theme Material -->


<!-- Help & Support -->
<!--

    <a href="mailto:hiviosey@gmail.com" class="sidebar-footer-text-a">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
        sidebar.help
        <span class="mdl-button__ripple-container">
          <span class="mdl-ripple"></span>
        </span>
      </div>
    </a>

-->

<!-- Feedback -->
<!--

    <a href="https://github.com/viosey/hexo-theme-material/issues" target="_blank" class="sidebar-footer-text-a">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
        sidebar.feedback
        <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
    </a>

-->

<!-- About Theme -->
<!--

    <a href="https://blog.viosey.com/index.php/Material.html" target="_blank" class="sidebar-footer-text-a">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
             sidebar.about_theme
            <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
    </a>

-->

    </div>

    <!-- Sidebar Image -->
    
    <span id="footer-image">
        <a href="https://www.upyun.com/" target="_blank" title="upyun_logo">
            <img src="/img/upyun_logo.svg" alt="upyun_logo"><!--
     --></a>
    </span>


</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/youyouvi" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    
        <a href="https://www.linkedin.com" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-linkedin">
                <span class="visuallyhidden">LinkedIn</span>
            </button><!--
     --></a>
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
    
    <!-- V2EX -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>Ember
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <!--<div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>-->
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?V/53wGualMuiPM3xoetD5Q==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>







    <!-- Busuanzi -->
    <script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



   <!-- Gitment -->





<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->

    
        
            <script>lsloader.load("prettify_js","/js/prettify.min.js?WN07fivHQSMKWy7BmHBB6w==", true)</script>
        
    



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
        
            $(function() {
                $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto;');
                prettyPrint();
                })
        
    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.0 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
